--DESAFIO


--MODO NORMAL
SELECT  D2_COD, D2_QUANT, DATEPART(MONTH,CONVERT(DATE,D2_EMISSAO)) MES FROM SD2990
WHERE  D2_EMISSAO BETWEEN '20210101' AND '20213112'
--AND D2_EMISSAO >= '20210101' AND D2_EMISSAO <= '20213112'


--PIVOT TABLE
SELECT 
SUM(PIVOTSD2.[1]) "1",
SUM(PIVOTSD2.[2]) "2",
SUM(PIVOTSD2.[3]) "3",  
SUM(PIVOTSD2.[4]) "4",
SUM(PIVOTSD2.[5]) "5",
SUM(PIVOTSD2.[6]) "6",
SUM(PIVOTSD2.[7]) "7",
SUM(PIVOTSD2.[8]) "8",
SUM(PIVOTSD2.[9]) "9",
SUM(PIVOTSD2.[10]) "10",
SUM(PIVOTSD2.[11]) "11",
SUM(PIVOTSD2.[12]) "12"

FROM SD2990 

--AQUI ACONTECE A MÁGICA
PIVOT (SUM(D2_QUANT) FOR DATEPART(MONTH,CONVERT(DATE,D2_EMISSAO))  IN ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])) AS PIVOTSD2
WHERE  D2_EMISSAO BETWEEN '20210101' AND '20213112'





